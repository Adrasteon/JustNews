# Crawl profile definitions for the Stage B crawler.
#
# Profiles describe how individual domains (or groups of domains) should be
# crawled when the scheduler dispatches work to the crawler agent. The default
# profile uses Crawl4AI to fetch the primary landing page for a site and rely on
# the existing extraction pipeline to generate structured articles. Specific
# domains can opt into deeper link traversal or alternative engines.
---
version: 1
defaults:
  profile: standard_crawl4ai
profiles:
  standard_crawl4ai:
    description: "Default Crawl4AI-assisted landing crawl"
    engine: crawl4ai
    mode: adaptive
    follow_internal_links: true
    max_pages: 50
    start_urls:
      - "https://{domain}"
    run_config:
      word_count_threshold: 60
      exclude_external_links: true
      remove_overlay_elements: true
      process_iframes: false
      table_score_threshold: 8
      markdown_generator:
        type: default
        content_filter:
          type: bm25
          user_query: "latest headlines {domain}"
          bm25_threshold: 1.0
    link_preview:
      include_internal: true
      include_external: false
      max_links: 100
      concurrency: 3
    adaptive:
      confidence_threshold: 0.7
      max_pages: 12
      top_k_links: 3
      min_gain_threshold: 0.05
    extra:
      query: "latest headlines {domain}"
  deep_financial_sections:
    description: "Deeper section crawl for complex financial publishers"
    engine: crawl4ai
    mode: section
    domains:
      - ft.com
      - wsj.com
    follow_internal_links: true
    max_pages: 8
    start_urls:
      - "https://{domain}/world/"
      - "https://{domain}/business/"
    run_config:
      word_count_threshold: 80
      exclude_external_links: true
      process_iframes: true
      table_score_threshold: 9
      markdown_generator:
        type: default
        content_filter:
          type: bm25
          user_query: "{domain} markets earnings"
          bm25_threshold: 1.3
    link_preview:
      include_internal: true
      include_external: false
      max_links: 20
      concurrency: 4
      query: "top stories"
      score_threshold: 0.25
    adaptive:
      confidence_threshold: 0.8
      max_pages: 16
      top_k_links: 4
      min_gain_threshold: 0.04
    extra:
      query: "{domain} markets earnings"
  bbc_high_volume:
    description: "High-volume Crawl4AI pass for BBC News"
    engine: crawl4ai
    mode: adaptive
    domains:
      - bbc.co.uk
      - bbc.com
    follow_internal_links: true
    max_pages: 120
    start_urls:
      - "https://www.bbc.co.uk/news"
      - "https://www.bbc.com/news"
      - "https://www.bbc.co.uk/news/world"
      - "https://www.bbc.co.uk/news/uk"
      - "https://www.bbc.co.uk/news/business"
      - "https://www.bbc.co.uk/news/politics"
      - "https://www.bbc.co.uk/news/science_and_environment"
      - "https://www.bbc.co.uk/news/technology"
      - "https://www.bbc.co.uk/news/entertainment_arts"
      - "https://www.bbc.co.uk/news/world/us_and_canada"
      - "https://www.bbc.co.uk/news/world/asia"
      - "https://www.bbc.co.uk/news/world/europe"
      - "https://www.bbc.com/news/world"
      - "https://www.bbc.com/news/uk"
      - "https://www.bbc.com/news/business"
      - "https://www.bbc.com/news/politics"
      - "https://www.bbc.com/news/science_and_environment"
      - "https://www.bbc.com/news/technology"
      - "https://www.bbc.com/news/entertainment_and_arts"
      - "https://www.bbc.com/news/world/us_and_canada"
      - "https://www.bbc.com/news/world/asia"
      - "https://www.bbc.com/news/world/europe"
    run_config:
      word_count_threshold: 70
      exclude_external_links: true
      remove_overlay_elements: true
      process_iframes: false
      table_score_threshold: 8
    link_preview:
      include_internal: true
      include_external: false
      max_links: 120
      concurrency: 1
      timeout: 15
      query: "latest news"
      score_threshold: 0.0
      include_patterns:
        - "/news/articles/"
        - "/news/world-"
        - "/news/uk-"
        - "/news/business-"
        - "/news/politics-"
        - "/news/science_and_environment-"
        - "/news/technology-"
        - "/news/entertainment-arts-"
        - "/news/world/us_and_canada-"
        - "/news/world/us-and-canada-"
        - "/news/world/asia-"
        - "/news/world/europe-"
        - "/news/world/africa-"
        - "/news/world/middle_east-"
        - "/news/world/middle-east-"
        - "/news/world/latin_america-"
        - "/news/world/latin-america-"
      exclude_patterns:
        - "/news/live/"
        - "/news/av/"
        - "/news/topics/"
        - "/news/video"
        - "/newsround/"
        - "/sport/"
        - "/weather/"
        - "news/live/"
        - "news/av/"
        - "news/topics/"
        - "news/video"
        - "newsround/"
        - "sport/"
        - "weather/"
        - "account.bbc.com"
        - "session.bbc.co.uk"
    adaptive:
      confidence_threshold: 0.5
      max_pages: 120
      top_k_links: 20
      min_gain_threshold: 0.01
    extra:
      query: "bbc latest headlines"
      disable_dedupe: true
      skip_seed_articles: true
      strict_skip_seed_articles: true
  legacy_generic:
    description: "Explicit opt-out of Crawl4AI for domains that rely on legacy logic"
    engine: generic
    domains:
      - reuters.com
      - apnews.com
