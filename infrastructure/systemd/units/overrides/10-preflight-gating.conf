# Drop-in override to gate JustNews instances with preflight
# Place as: /etc/systemd/system/justnews@<instance>.service.d/10-preflight-gating.conf
# or apply programmatically for selected instances.

[Unit]
# Ensure network is fully up
After=network-online.target
Wants=network-online.target

[Service]
# Increase startup timeout to allow model preload to complete
TimeoutStartSec=300
# Block start if preflight (gate-only) fails; pass instance name
ExecStartPre=/usr/bin/env bash -lc '/usr/local/bin/justnews-preflight-check.sh --gate-only %i'
