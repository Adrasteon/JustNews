# Crawl profile definitions for the Stage B crawler.
#
# Profiles describe how individual domains (or groups of domains) should be
# crawled when the scheduler dispatches work to the crawler agent. The default
# profile uses Crawl4AI to fetch the primary landing page for a site and rely on
# the existing extraction pipeline to generate structured articles. Specific
# domains can opt into deeper link traversal or alternative engines.
---
version: 1
defaults:
  profile: standard_crawl4ai
profiles:
  standard_crawl4ai:
    description: "Default Crawl4AI-assisted landing crawl"
    engine: crawl4ai
    mode: landing
    follow_internal_links: true
    max_pages: 50
    start_urls:
      - "https://{domain}"
    run_config:
      word_count_threshold: 60
      exclude_external_links: true
      remove_overlay_elements: true
      process_iframes: false
      table_score_threshold: 8
      markdown_generator:
        type: default
        content_filter:
          type: bm25
          user_query: "latest headlines {domain}"
          bm25_threshold: 1.0
    link_preview:
      include_internal: true
      include_external: false
      max_links: 100
      concurrency: 3
    adaptive:
      confidence_threshold: 0.7
      max_pages: 12
      top_k_links: 3
      min_gain_threshold: 0.05
    extra:
      query: "latest headlines {domain}"
  deep_financial_sections:
    description: "Deeper section crawl for complex financial publishers"
    engine: crawl4ai
    mode: section
    domains:
      - ft.com
      - wsj.com
    follow_internal_links: true
    max_pages: 8
    start_urls:
      - "https://{domain}/world/"
      - "https://{domain}/business/"
    run_config:
      word_count_threshold: 80
      exclude_external_links: true
      process_iframes: true
      table_score_threshold: 9
      markdown_generator:
        type: default
        content_filter:
          type: bm25
          user_query: "{domain} markets earnings"
          bm25_threshold: 1.3
    link_preview:
      include_internal: true
      include_external: false
      max_links: 20
      concurrency: 4
      query: "top stories"
      score_threshold: 0.25
    adaptive:
      confidence_threshold: 0.8
      max_pages: 16
      top_k_links: 4
      min_gain_threshold: 0.04
    extra:
      query: "{domain} markets earnings"
  legacy_generic:
    description: "Explicit opt-out of Crawl4AI for domains that rely on legacy logic"
    engine: generic
    domains:
      - reuters.com
      - apnews.com
